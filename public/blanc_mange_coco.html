<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blanc Mangé Coco</title>

<style>
/* POLICES */
@font-face {
  font-family: "TFMadloud";
  src: url("fonts/TF-Madloud.ttf") format("truetype");
}

/* GLOBALE */
body {
  margin: 0;
  background: #031d11;
  font-family: "TFMadloud", sans-serif;
  color: #0DFF8A;
  overflow-x: hidden;
}

h2, h3 { margin: 10px 0; }

/* CONTAINER */
#container {
  display: flex;
  height: 100vh;
}

/* JOUEURS À DROITE */
#joueurs {
  width: 230px;
  background: #062b1a;
  padding: 15px;
  border-left: 3px solid #0DFF8A;
  overflow-y: auto;
}

#joueurs h3 { text-align: center; }

.joueur {
  padding: 8px;
  margin-bottom: 6px;
  background: #094327;
  border-radius: 8px;
}

/* ZONE JEU */
#zoneJeu {
  flex: 1;
  padding: 20px;
}

/* CARTE QUESTION */
#carteQuestion {
  background: white;
  color: black;
  padding: 20px;
  border-radius: 12px;
  width: 350px;
  margin: 0 auto;
  font-family: Arial, sans-serif;
}

/* BOUTONS */
button {
  font-family: "TFMadloud";
  background: #0DFF8A;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
  cursor: pointer;
  margin: 5px;
}

button:hover {
  background: #0bdf76;
}

/* CARTES */
.mainCarte {
  background: white;
  color: black;
  width: 180px;
  padding: 18px;
  margin: 10px;
  border-radius: 12px;
  cursor: pointer;
  font-family: Arial, sans-serif;
  transition: 0.2s;
}

.mainCarte:hover { transform: scale(1.06); }

#main {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}

/* CARTES POSÉES */
#cartesPosees {
  display: flex;
  justify-content: center;
  gap: 15px;
  margin-top: 25px;
}

.cartePosee {
  background: white;
  width: 160px;
  padding: 18px;
  border-radius: 10px;
  font-family: Arial, sans-serif;
}

/* CHAT */
#chatBox {
  background: #062b1a;
  border-top: 3px solid #0DFF8A;
  padding: 10px;
  height: 200px;
  overflow-y: auto;
}

#chatInput {
  width: 70%;
  padding: 8px;
}
</style>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
let pseudo = "";

/* DEMANDE PSEUDO */
window.onload = () => {
  pseudo = prompt("Entrez votre pseudo :");
  socket.emit("rejoindreSalon", pseudo);
};

/* RÉCEPTION MAIN */
socket.on("main", (main) => {
  const div = document.getElementById("main");
  div.innerHTML = "";
  main.forEach((c, idx) => {
    const el = document.createElement("div");
    el.className = "mainCarte";
    el.innerText = c;
    el.onclick = () => socket.emit("poserCarteIndex", idx);
    div.appendChild(el);
  });
});

/* QUESTION */
socket.on("question", (q) => {
  document.getElementById("carteQuestion").innerText = q;
});

/* CARTES POSÉES */
socket.on("cartesPosees", (cartes) => {
  const zone = document.getElementById("cartesPosees");
  zone.innerHTML = "";
  cartes.forEach((c) => {
    let el = document.createElement("div");
    el.className = "cartePosee";
    el.innerText = c.carte;
    zone.appendChild(el);
  });
});

/* CHAT */
socket.on("chatMessage", (m) => {
  const box = document.getElementById("chatBox");
  box.innerHTML += `<div>${m}</div>`;
  box.scrollTop = box.scrollHeight;
});
</script>

</head>
<body>

<div id="container">

  <div id="zoneJeu">
    <h2>Blanc Mangé Coco</h2>

    <div id="carteQuestion">Chargement...</div>

    <div style="margin-top:15px;">
      <button onclick="socket.emit('changerQuestion')">Changer Question</button>
      <button onclick="socket.emit('changerMain')">Changer Main</button>
    </div>

    <h3>Cartes posées :</h3>
    <div id="cartesPosees"></div>

    <h3>Votre main :</h3>
    <div id="main"></div>

    <h3>Chat :</h3>
    <div id="chatBox"></div>
    <input id="chatInput" onkeypress="if(event.key==='Enter'){ socket.emit('chatMessage', this.value); this.value=''; }" placeholder="Message...">
  </div>

  <div id="joueurs">
    <h3>Joueurs</h3>
    <div id="listeJoueurs"></div>
  </div>

</div>
</body>
</html>
