<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BMC Mobile</title>

<style>
body {
  margin: 0;
  background: #0a0a0a;
  color: white;
  font-family: Arial, sans-serif;
  overflow: hidden;
}

#question {
  padding: 10px;
  border-bottom: 2px solid #0DFF8A;
  text-align: center;
}

.zone {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  padding: 10px;
}

.card {
  width: 140px;
  height: 200px;
  background: url("carte.png") no-repeat center/100% 100%;
  position: relative;
  flex-shrink: 0;
}

.text {
  position: absolute;
  top: 8px;
  left: 8px;
  right: 8px;
  color: black;
  font-size: 0.9rem;
}

#main {
  position: absolute;
  bottom: 0;
  width: 100%;
}
</style>
</head>

<body>

<div id="question">Chargement...</div>
<div id="posed" class="zone"></div>
<div id="main" class="zone"></div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const main = document.getElementById("main");
const posed = document.getElementById("posed");
const question = document.getElementById("question");

socket.on("question", q => question.textContent = q);

socket.on("main", cartes => {
  main.innerHTML = "";
  cartes.forEach((txt, i) => {
    const c = document.createElement("div");
    c.className = "card";
    c.onclick = () => socket.emit("poserCarteIndex", i);

    const t = document.createElement("div");
    t.className = "text";
    t.textContent = txt;

    c.appendChild(t);
    main.appendChild(c);
  });
});

socket.on("cartesPoseesPreview", cartes => {
  posed.innerHTML = "";
  cartes.forEach(txt => {
    const c = document.createElement("div");
    c.className = "card";
    c.innerHTML = `<div class="text">${txt}</div>`;
    posed.appendChild(c);
  });
});

socket.on("presentationCarte", data => {
  posed.innerHTML = "";
  const c = document.createElement("div");
  c.className = "card";
  c.innerHTML = `<div class="text">${data.texte}</div>`;
  c.onclick = () => socket.emit("carteSuivante");
  posed.appendChild(c);
});

socket.on("phaseVote", cartes => {
  posed.innerHTML = "";
  cartes.forEach((txt, i) => {
    const c = document.createElement("div");
    c.className = "card";
    c.onclick = () => socket.emit("voter", i);
    c.innerHTML = `<div class="text">${txt}</div>`;
    posed.appendChild(c);
  });
});

setTimeout(() => {
  const pseudo = prompt("Pseudo ?");
  socket.emit("rejoindreSalon", pseudo);
}, 300);
</script>
</body>
</html>
